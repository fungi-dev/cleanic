# Cleanic -> Core
Разработка слоя Core целевого приложения должна вестись на основе кода этого проекта. Здесь три группы классов, три папки:
- Language для описания общего языка и предоставления информации о нём всем остальным частям кода.
- Domain для программирования бизнес-логики, логики выполнения команд.
- Projection для определения процесса построения вьюх, которые пользователи приложения смогут запрашивать.
Классы разделены на три группы потому, что приложение должно строиться на основе архитектурного шаблона CQRS. Language нужен всем, а Domain и Projection будут использованы в соответствующих частях целевого приложения.

В каждой группе две подгруппы:
- Base – классы, наследуясь от которых прикладной программист определяет классы слоя целевого приложения.
- Schema – классы, которые представляют мета описание языка/домена/проджекторов (как рефлекшн в дотнете). Такое описание нужно другим слоям, чтобы слой апликейшен мог обрабатывать запросы и выполнять свою работу не зная конкретной предметки. Таким образом достигнута универсальная природа слоя апликейшен в клинике; прикладному программисту не нужно писать этот слой, достаточно использовать клинический. При запуске приложения Application должен узнать предметку. Для этого у него есть методы, принимающие `LanguageSchema`, `DomainSchema` (часть приложения для записи), `ProjectionSchema` (часть приложения для чтения). Прикладной прграммист должен эти схемы подготовить. В этом ему помогает класс `*SchemaBuilder`, он принимает классы, описывающие все объекты и строит схему. Как пользваться построителями схем, показано в спеках (авто-тестах).

## Language
Язык следует воспринимать, как нечто независящее от приложения, нечто существующее в вакууме. Чистая логика, описание происходящего в бизнесе. Хорошим вариантом выяснения/выявления языка является ивент шторминг.

События здесь – это не ивент-сорсед события, а доменные. В отличие от ивент-сорсед событий доменные менее подробны, могут иметь дублирующие данные. Их цель – нести высокоуровневую информацию о том, что происходит в бизнесе; быть инструментом интеграции.

### Terms
- Term: любое слово языка
    - BehavioralTerm: слово, обозначающее какое-то поведение
        - Message: описание намерения, может складываться в очередь для обработки, отправитель ожидает обработки своего сообщения
            - Request: само изначальное намерение
                - Command: запрос на изменение предметки, сопровождаемые детальными данными для произведения такого изменения
                - Query: запрос на чтение актуального состояния предметки, сопровождённый параметрами/фильтрами/условиями выборки
            - Response: информация о реакции на намерение, ответ на реквест
                - CommandResult: информация об ошибках при наличии или о принятой к исполнению команды и дальнейших доступных действиях
                - AggregateView: кусок состояния предметки, определённый/ограниченный запросом
        - Event: описание произошедшего факта, отправителю пофигу на получателей
            - DomainEvent: информация об изменении в предметке, может использваться для интеграции путём подписки
            - DomainError: информация о том, что в предметке была попытка изменения, но она не удалась; также может использоваться для интеграции путём подписки
    - StructuralTerm: слово, описывающее некий объект в статике, его состояние
        - Aggregate: объект предметки, к которому можно применять commands или запрашивать его состояние с помощью query
        - Area: область предметки, имеющая обособленное самостоятельное значение с точки зрения бизнеса, содержит агрегаты

# Domain
Здесь запрограммирована логика обработки команд. Команды собраны в агрегаты, которые в свою очередь собраны в поддомены. Агрегат является границами консистентности. Агрегаты – ивент сорсед, сохраняются в базе в виде набора событий, в виде своей истории. Это события агрегата, а не доменные. Их назначение хранить состояние агрегатов и передавать информацию о состоянии домена в рид-сайд, в Projection. Снаружи поддомена эти события не должны быть видны, это детали подсистемы хранения, внутренние детали реализации.

# Projection
Здесь лежат проджекторы, которые строят вьюхи на основе возникающих событий агрегата.